<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tree Testing</title>
	<script type="text/javascript" src="js/jquery-1.3.1.min.js"></script>
	<script type="text/javascript" src="js/jquery.simple.tree.js"></script>
	<link rel="stylesheet" type="text/css" href="js/jquery.simple.tree.css">

	<script type="text/javascript">
	var CurrName = "Contacts";
	var simpleTreeCollection = "";
	
	$(document).ready(function() {
		updateTree();
		
		$('.scroll-pane').jScrollPane();
	});
	

	function updateTree()
	{
		if (simpleTreeCollection != "")
		{
			//simpleTreeCollection.remove();
		}
		//$('#treeholder').html("<ul id='browser' class='simpleTree'><li class='root' id='Eldritch'><span>Eldritch</span><ul><li id='QualDraw'><span class='text'>Qualities/Drawbacks</span><ul class='ajax'><li id='QDURL'>{url:populateQDTree.php}</li></ul></li></ul></li></ul>");
		$.ajax({
			type: "GET",
			url: "populateQDTree.php",
			contentType:'html',
			cache:false,
			success: function(response){ 
				var treestring = "<ul id='browser' class='simpleTree'><li class='root' id='Eldritch'><span>Eldritch</span><ul>" + 
								 response + 
								"</ul></li></ul>";
				$('#treeholder').html(treestring);
				createTree();
			}
		});		
	}


	function createTree()
	{
		simpleTreeCollection = $('.simpleTree').simpleTree({
			animate: true,
			autoclose: false,
			drag: false,
			afterClick:function(node){ return ClickTree(node); }
		});
		
		if (CurrName != "")
		{
			var currtree = simpleTreeCollection[0];
			var tmpName = CurrName.replace(/ /g, "");
	
			if (tmpName != "Qualities" && tmpName != "Drawbacks")
			{
				currtree.nodeToggle($('#' + $('#' + tmpName, currtree).parent().parent().attr("id"), currtree)[0]);
				$('#' + tmpName + ' > span', currtree).trigger('click');
			}
		}
	}
	
	function ClickTree(node)
	{
		CurrName = node.find('>span').text();
		alert(CurrName);
		//alert($('span.active', simpleTreeCollection[0]).text());
		//$('#welcome').load($('span:first',node).text().replace(/ /g, '').toLowerCase()+'.html');
	}

	</script>


	<style type="text/css">
		.tree-pane {
			width: 250px;
			float: left;
			border: medium double rgb(0,0,0)
		}
    </style>

</head>

<body>
	<div id = 'treeholder' class = 'tree-pane'>
        
    </div>
    <hr width="200px" />
<form action="index.html" method="post" name="main">
<input type="button" name="btnSubmit" id="btnSubmit" value="Submit" onclick="updateTree()"/>
</form>
</body>
</html>
